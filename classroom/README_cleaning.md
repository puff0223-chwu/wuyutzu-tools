# 🧹 打掃工作徵才系統 v3.3

加權隨機機率模型的打掃工作分配系統

## ✨ 特色功能

### 🎯 數學正確的機率模型
- 採用加權隨機演算法
- 實際中選機率 = 個人權重 ÷ 總權重
- 符合數學定義,公平透明
- 所有機率加總 = 100%

### 📋 預設打掃項目
系統已預設7個教室打掃項目,開箱即用:
1. [教室]地板天花板 - 5人
2. [教室]倒垃圾(含陽台地板) - 3人
3. [教室]黑板教師桌 - 2人
4. [教室]書櫃電腦櫃圖書櫃 - 4人
5. [教室]擦門窗 - 5人
6. [教室]洗手台飲水機 - 2人
7. [教室]抬餐(含廚餘、清潔) - 3人

可自由編輯/刪除/新增項目

### 💎 資源權重系統
預設三種資源:
- **金幣**: 每30個 → 權重+1
- **老師簽名卡**: 每1張 → 權重+20
- **最強王牌**: 每1張 → 權重+50

可自訂新增其他資源

### 🔄 多輪累積徵選
- 支援多輪徵選
- 已中選者自動排除
- 已滿額項目自動隱藏
- 結果逐輪累積

### 📊 雙格式匯出

**格式1: 依打掃項目分類**
```
中籤打掃項目 | 座號 | 姓名
```
- 用途: 製作班級打掃表、公告中選名單
- 只顯示中選者

**格式2: 依學生統計**
```
座號 | 姓名 | 徵選輪次 | 投入資源種類 | 投入資源數量 | 中籤與否
```
- 用途: 統計資源使用、確認資源扣除
- 包含所有參與記錄(中選+未中選)

### 🎲 自動隨機分配
- 上傳班級名單後啟用
- 自動分配剩餘職缺
- 從未分配學生中隨機抽取
- 確保所有職缺填滿

### 📥 內建範例下載
所有範例檔案可直接在系統內下載:
- 班級名單範例
- 徵選名單範例
- 無需額外準備

## 🚀 快速開始

### 1分鐘上手

1. 開啟 `cleaning-jobs.html`
2. 打掃項目已預設好 ✅
3. 上傳班級名單 (點擊「下載範例」取得格式)
4. 學生填寫 Google 表單投標
5. 上傳徵選名單 (點擊「下載範例」取得格式)
6. 開始抽籤!

### 詳細流程

#### 步驟0: 基本設定
1. 確認資源設定 (預設即可使用)
2. 確認打掃項目 (預設7項)
3. 上傳班級名單

#### 步驟1-N: 多輪徵選
1. 學生填寫表單投標
2. 下載表單回應為 Excel
3. 上傳到系統
4. 系統自動跳轉到抽籤頁
5. 逐一點擊「開始抽籤」
6. 查看結果

#### 步驟Final: 完整結果
1. 進入「完整結果」頁面
2. 查看徵選統計
3. 執行隨機分配 (如有剩餘職缺)
4. 下載結果 Excel

## 📊 機率計算範例

### 範例: 擦窗戶 (需要1人, 3人投標)

| 參與者 | 投入資源 | 權重 | 實際機率 |
|--------|---------|------|----------|
| 小明 | 150金幣 | 5 | 5÷95 = 5.3% |
| 小華 | 2張簽名卡 | 40 | 40÷95 = 42.1% |
| 小美 | 1張王牌 | 50 | 50÷95 = 52.6% |
| **總計** | - | **95** | **100%** |

- 小美權重最高,中選機率最大
- 但不是100%保證
- 小明仍有5.3%的機會

## 📁 檔案格式

### 班級名單
```
座號 | 姓名
1    | 王小明
2    | 李小華
```

### 徵選名單
```
座號 | 姓名   | 參與打掃項目        | 投入資源種類 | 資源投入數量 | 徵選輪次
1    | 王小明 | [教室]地板天花板    | 金幣        | 150         | 第1輪
2    | 李小華 | [教室]擦門窗       | 老師簽名卡   | 2           | 第1輪
```

## 🎯 系統架構

### 6個分頁

1. **💎 資源設定** - 管理資源種類與權重
2. **📋 打掃項目** - 管理打掃工作 (預設7項)
3. **👥 班級名單** - 上傳全班學生
4. **📤 上傳名單** - 上傳各輪徵選名單
5. **🎰 徵選抽籤** - 加權隨機抽籤
6. **🏆 完整結果** - 查看結果與匯出

## 💡 使用技巧

### 學生策略建議

**保守型**: 用少量資源投多個項目,分散風險

**激進型**: 集中資源投最想要的項目,提高單項機率

**平衡型**: 第1輪用中等資源,觀察後調整

### 老師建議

1. 事前說明機率規則
2. 提供資源使用建議
3. 建議多輪設計給予更多機會
4. 最後使用隨機分配填滿職缺
5. 公開中選名單增加公信力

## 🔧 技術規格

- 純前端實作 (HTML/CSS/JavaScript)
- localStorage 本地儲存
- SheetJS 處理 Excel
- 加權隨機演算法 (Weighted Random Selection)
- 響應式設計支援行動裝置

## 📝 版本歷史

### v3.3 最終版 (2025/01/01)
- ✅ 預設7個打掃項目
- ✅ 雙匯出格式(依項目/依學生)
- ✅ 內建範例檔案下載

### v3.2 (2024/12/31)
- ✅ 新增班級名單管理
- ✅ 新增隨機分配功能
- ✅ 多輪流程修正

### v3.1 (2024/12/31)
- ✅ 改用加權隨機機率模型
- ✅ 數學正確的機率計算

### v3.0 (2024/12/31)
- ✅ 機率抽籤版本
- ✅ 多輪累積機制

### v2.0 (2024/12/30)
- ✅ 多輪累加+隨機分配

### v1.0 (2024/12/30)
- ✅ 競標模式

## 👨‍💻 作者

程式設計: 巫魚子 © 2025

- 🌐 網站: https://sites.google.com/view/teacher-wuyutzu/
- 📺 YouTube: https://www.youtube.com/@chwu0223

## 📝 授權

僅供教育用途使用
